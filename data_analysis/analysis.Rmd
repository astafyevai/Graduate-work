#иняз общее

library(stringr)
library(tidyverse)
library(dplyr)

data = read.csv("analysis.csv") #грузим данные
data$foreign = sapply(data$foreign, as.character) #выбираем, что хотим анализировать
data [data$foreign %in% c('three','zero','six','one','two','four'),] %>% #расформировываем столбец в несколько на основании значений
  na.omit() %>% #игнорируем NA
  count(foreign,stimulus) %>% #выбираем даныые, которые нужно учесть при анализе
  spread(key = foreign, value = n) %>% #key - имя столбца/позиции передается в value (считает)
  mutate(zero = ifelse(is.na(`zero`), as.integer(0), `zero`),  #меняем таблицу: is.na() считаем 0 и вписываем нужные значения
         one = ifelse(is.na(`one`), as.integer(0), `one`),
         two = ifelse(is.na(`one`), as.integer(0), `two`),
         three = ifelse(is.na(`three`), as.integer(0), `three`),
         four = ifelse(is.na(`one`), as.integer(0), `four`),
         six = ifelse(is.na(`six`), as.integer(0), `six`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, zero, one, two, three, four, six) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test[,-1],simulate.p.value=TRUE,B=1e5)

#муз образование не влияет на ответы

library(stringr)
library(tidyverse)
library(dplyr)

data = read.csv("analysis.csv") #грузим данные
data$music = sapply(data$music, as.character) #выбираем, что хотим анализировать
data [data$music %in% c('yes','no'),] %>% #расформировываем столбец в несколько на основании значений
  na.omit() %>% #игнорируем NA
  count(music,stimulus) %>% #выбираем даныые, которые нужно учесть при анализе
  spread(key = music, value = n) %>% #key - имя столбца/позиции передается в value (счет)
  mutate(yes = ifelse(is.na(`yes`), as.integer(0), `yes`),  #меняем таблицу: is.na() считаем 0 и вписываем нужные значения
         no = ifelse(is.na(`no`), as.integer(0), `no`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, yes, no) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

#пол не влияет на ответы

data = read.csv("analysis.csv")
data$gender = sapply(data$gender, as.character)
data [data$gender %in% c('f','m'),] %>%
  na.omit() %>% 
  count(gender,stimulus) %>% 
  spread(key = gender, value = n) %>% 
  mutate(f = ifelse(is.na(`f`), as.integer(0), `f`),  
         m = ifelse(is.na(`m`), as.integer(0), `m`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, f, m) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

#лингобр влияет на ответы

data = read.csv("analysis.csv")
data$ling = sapply(data$ling, as.character)
data [data$ling %in% c('yes','no'),] %>%
  na.omit() %>% 
  count(ling,stimulus) %>% 
  spread(key = ling, value = n) %>% 
  mutate(yes = ifelse(is.na(`yes`), as.integer(0), `yes`),  
         no = ifelse(is.na(`no`), as.integer(0), `no`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, yes, no) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)


#состояние влияет на ответы

data = read.csv("analysis.csv")
data$real_condition = sapply(data$real_condition, as.character)
data [data$real_condition %in% c('liquid','soft', 'hard'),] %>%
  na.omit() %>% 
  count(real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),  
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)


#количество слогов влияет на ответы

data = read.csv("analysis.csv")
data$X = sapply(data$X, as.character)
data [data$X %in% c('one.syll', 'two.syll'),] %>%
  na.omit() %>% 
  count(X,stimulus) %>% 
  spread(key = X, value = n) %>% 
  mutate(one.syll = ifelse(is.na(`one.syll`), as.integer(0), `one.syll`),  
         two.syll = ifelse(is.na(`two.syll`), as.integer(0), `two.syll`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, one.syll, two.syll) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

#про отдельные слова

library(stringr)
library(tidyverse)
library(ggplot2)
library(dplyr)


data = read.csv("analysis.csv")
data$really = (sapply(data$really, as.character))
data [data$really %in% c('tot.kot','stol.skol','tort.kort','stolko.skolko','tomik.komik','tonus.konus', 'czaplya.kaplya'),]  %>% 
na.omit() %>% 
  count(really,stimulus) %>% 
  spread(key = really, value = n) %>% 
  mutate(tot.kot = ifelse(is.na(`tot.kot`), as.integer(0), `tot.kot`),
         stol.skol = ifelse(is.na(`stol.skol`), as.integer(0), `stol.skol`),  
         tort.kort = ifelse(is.na(`tort.kort`), as.integer(0), `tort.kort`),
         stolko.skolko = ifelse(is.na(`stolko.skolko`), as.integer(0), `stolko.skolko`),  
         tomik.komik = ifelse(is.na(`tomik.komik`), as.integer(0), `tomik.komik`),  
         tonus.konus = ifelse(is.na(`tonus.konus`), as.integer(0), `tonus.konus`),  
         czaplya.kaplya = ifelse(is.na(`czaplya.kaplya`), as.integer(0), `czaplya.kaplya`),  
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, tot.kot, stol.skol, 	tort.kort, stolko.skolko, tomik.komik, 	tonus.konus, czaplya.kaplya) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)


#связь длины и влияния состояния (один слог): нет

data = read.csv("analysis.csv")
data [data$real_condition %in% c('liquid','soft','hard') & data$X == "one.syll",]  %>% 
  na.omit() %>% 
  count(X, real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),  
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

#связь длины и влияния состояния (два слога): когдв люди произносят два слога, на слушающих влияет состояние, значит, не можем сказать, что влияет по отдельности

data = read.csv("analysis.csv")
data [data$real_condition %in% c('liquid','soft','hard') & data$X == "two.syll",]  %>% 
  na.omit() %>% 
  count(X, real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),  
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

