# график ответов (общий)


We expected that all participants of the experiment would consider the stimuli pairs as one word. If at least one subject decides that there are two different words among the stimuli pairs, we will consider our hypothesis incorrect. 

data = read.csv("analysis.csv")
barplot(table(data$stimulus), ylab='Number of responses', main='Identical/Different Distribution', col = 'pink')

The barplot presents that in the total for stimuli the “different” answer option exceeds the “identical” option. Some subjects could not determine whether a pair of stimuli was different words or the same. On the graph, this is the first column without a title; it will not be taken into account with further analysis.

(The barplot presents/indicates/manifests that...)


# график ответов (отдельные пары стимулов). подумать, как смэтчить и трактовать результаты теста (отличается только? одно? слово, проверить всех носителей на понятность)

library(stringr)
library(tidyverse)
library(ggplot2)
library(dplyr)

data = read.csv("analysis.csv")
data$really = (sapply(data$really, as.character))
data [data$really %in% c('tot.kot','stol.skol','tort.kort','stolko.skolko','tomik.komik','tonus.konus', 'czaplya.kaplya'),]  %>% 
na.omit() %>% 
  count(really,stimulus) %>% 
  spread(key = really, value = n) %>% 
  mutate(tot.kot = ifelse(is.na(`tot.kot`), as.integer(0), `tot.kot`),
         stol.skol = ifelse(is.na(`stol.skol`), as.integer(0), `stol.skol`),  
         tort.kort = ifelse(is.na(`tort.kort`), as.integer(0), `tort.kort`),
         stolko.skolko = ifelse(is.na(`stolko.skolko`), as.integer(0), `stolko.skolko`),  
         tomik.komik = ifelse(is.na(`tomik.komik`), as.integer(0), `tomik.komik`),  
         tonus.konus = ifelse(is.na(`tonus.konus`), as.integer(0), `tonus.konus`),  
         czaplya.kaplya = ifelse(is.na(`czaplya.kaplya`), as.integer(0), `czaplya.kaplya`),  
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, tot.kot, stol.skol, 	tort.kort, stolko.skolko, tomik.komik, 	tonus.konus, czaplya.kaplya) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

data.graph <- as.data.frame(t(data_test))
data.graph$names <- rownames(data.graph)
test = data_test
row.names(test)[1] <- 'Different'
test <- stack(test)
test$variant <- rep(c('Different','Same'),7)
ggplot(test, aes(x=ind, y=values, fill=variant)) +
  geom_bar(stat="identity", position=position_dodge())



#иняз общее

library(stringr)
library(tidyverse)
library(dplyr)

data = read.csv("analysis.csv") #грузим данные
data$foreign = sapply(data$foreign, as.character) #выбираем, что хотим анализировать
data [data$foreign %in% c('three','zero','six','one','two','four'),] %>% #расформировываем столбец в несколько на основании значений
  na.omit() %>% #игнорируем NA
  count(foreign,stimulus) %>% #выбираем даныые, которые нужно учесть при анализе
  spread(key = foreign, value = n) %>% #key - имя столбца/позиции передается в value (считает)
  mutate(zero = ifelse(is.na(`zero`), as.integer(0), `zero`),  #меняем таблицу: is.na() считаем 0 и вписываем нужные значения
         one = ifelse(is.na(`one`), as.integer(0), `one`),
         two = ifelse(is.na(`one`), as.integer(0), `two`),
         three = ifelse(is.na(`three`), as.integer(0), `three`),
         four = ifelse(is.na(`one`), as.integer(0), `four`),
         six = ifelse(is.na(`six`), as.integer(0), `six`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, zero, one, two, three, four, six) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

Fisher's Exact Test for Count Data with simulated p-value (based on 1e+05 replicates)
data:  data_test
p-value = 0.00052
alternative hypothesis: two.sided

#муз образование не влияет на ответы

library(stringr)
library(tidyverse)
library(dplyr)

data = read.csv("analysis.csv") #грузим данные
data$music = sapply(data$music, as.character) #выбираем, что хотим анализировать
data [data$music %in% c('yes','no'),] %>% #расформировываем столбец в несколько на основании значений
  na.omit() %>% #игнорируем NA
  count(music,stimulus) %>% #выбираем даныые, которые нужно учесть при анализе
  spread(key = music, value = n) %>% #key - имя столбца/позиции передается в value (счет)
  mutate(yes = ifelse(is.na(`yes`), as.integer(0), `yes`),  #меняем таблицу: is.na() считаем 0 и вписываем нужные значения
         no = ifelse(is.na(`no`), as.integer(0), `no`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, yes, no) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

	Fisher's Exact Test for Count Data

data:  data_test
p-value = 0.1165
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.9257751 1.8994032
sample estimates:
odds ratio 
  1.324402 

#пол не влияет на ответы

data = read.csv("analysis.csv")
data$gender = sapply(data$gender, as.character)
data [data$gender %in% c('f','m'),] %>%
  na.omit() %>% 
  count(gender,stimulus) %>% 
  spread(key = gender, value = n) %>% 
  mutate(f = ifelse(is.na(`f`), as.integer(0), `f`),  
         m = ifelse(is.na(`m`), as.integer(0), `m`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, f, m) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

Fisher's Exact Test for Count Data
data:  data_test
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.7105923 1.3914761
sample estimates:
odds ratio 
 0.9945437 

#лингобр влияет на ответы

data = read.csv("analysis.csv")
data$ling = sapply(data$ling, as.character)
data [data$ling %in% c('yes','no'),] %>%
  na.omit() %>% 
  count(ling,stimulus) %>% 
  spread(key = ling, value = n) %>% 
  mutate(yes = ifelse(is.na(`yes`), as.integer(0), `yes`),  
         no = ifelse(is.na(`no`), as.integer(0), `no`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, yes, no) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

Fisher's Exact Test for Count Data
data:  data_test
p-value = 0.0004936
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 1.316252 2.932600
sample estimates:
odds ratio 
  1.957039 


#состояние влияет на ответы

data = read.csv("analysis.csv")
data$real_condition = sapply(data$real_condition, as.character)
data [data$real_condition %in% c('liquid','soft', 'hard'),] %>%
  na.omit() %>% 
  count(real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),  
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

	Fisher's Exact Test for Count Data with simulated p-value (based on 1e+05 replicates)
data:  data_test
p-value = 0.04941
alternative hypothesis: two.sided

#количество слогов влияет на ответы

data = read.csv("analysis.csv")
data$X = sapply(data$X, as.character)
data [data$X %in% c('one.syll', 'two.syll'),] %>%
  na.omit() %>% 
  count(X,stimulus) %>% 
  spread(key = X, value = n) %>% 
  mutate(one.syll = ifelse(is.na(`one.syll`), as.integer(0), `one.syll`),  
         two.syll = ifelse(is.na(`two.syll`), as.integer(0), `two.syll`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, one.syll, two.syll) ->
  data_test
data_test = data_test[2:3,-1]
#data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

	Fisher's Exact Test for Count Data with simulated p-value (based on 1e+05 replicates)

data:  data_test
p-value = 0.04998
alternative hypothesis: two.sided

#связь длины и влияния состояния (один слог): нет

data = read.csv("analysis.csv")
data [data$real_condition %in% c('liquid','soft','hard') & data$X == "one.syll",]  %>% 
  na.omit() %>% 
  count(X, real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),  
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

Fisher's Exact Test for Count Data with simulated p-value (based on 1e+05 replicates)
data:  data_test
p-value = 0.1128
alternative hypothesis: two.sided

#связь длины и влияния состояния (два слога): когдв люди произносят два слога, на слушающих влияет состояние, значит, не можем сказать, что влияет по отдельности (то есть влияет какой-то общий фактор)

data = read.csv("analysis.csv")
data [data$real_condition %in% c('liquid','soft','hard') & data$X == "two.syll",]  %>% 
  na.omit() %>% 
  count(X, real_condition,stimulus) %>% 
  spread(key = real_condition, value = n) %>% 
  mutate(liquid = ifelse(is.na(`liquid`), as.integer(0), `liquid`),
         soft = ifelse(is.na(`soft`), as.integer(0), `soft`),  
         hard = ifelse(is.na(`hard`), as.integer(0), `hard`),
         type = paste(stimulus)) %>% 
  ungroup() %>% 
  select(type, liquid, soft, hard) ->
  data_test
data_test = data_test[2:3,-1]
data_test
fisher.test(data_test,simulate.p.value=TRUE,B=1e5)

Fisher's Exact Test for Count Data with simulated p-value (based on 1e+05 replicates)

data:  data_test
p-value = 0.00418
alternative hypothesis: two.sided

